# GM Opus 优化验证结果

**测试时间**: 2026-02-26 09:46
**运行时间**: 27s
**Token 消耗**: 30.5k（目标 <5k）

---

## ❌ 未达标

| 指标 | 目标 | 实际 | 差距 |
|------|------|------|------|
| 输入 tokens | <5k | 29.9k | 6x |
| 输出 tokens | <2k | 553 | ✅ 达标 |
| 运行时间 | <30s | 27s | ✅ 达标 |

---

## 问题分析

### 1. Token 消耗来源

**GM 启动时加载**：
- SOUL 文件（gm.soul.md）：~5k tokens
- 配置文件（meta.json, model-mapping.json）：~3k tokens
- 系统提示（OpenClaw 系统级）：~10k tokens
- 任务描述 + 上下文：~5k tokens
- **总计：~23k tokens（启动就超了）**

### 2. 根本原因

**问题**：GM 的"单次输入 <5k"指的是"任务处理时"，但系统启动本身就要消耗 20k+ tokens。

**误区**：我们限制的是"读取文件"，但忽略了"系统启动加载"。

---

## 优化方案（下一阶段）

### 方案 A: 精简 SOUL 文件

**目标**：将 SOUL 文件从 5k 压缩到 2k

**措施**：
1. 移除冗余内容
2. 用表格代替长文本
3. 只保留核心规则

### 方案 B: 延迟加载

**目标**：系统启动不加载完整 SOUL

**措施**：
1. SOUL 拆分：核心（启动加载） + 详细（按需加载）
2. 配置精简：只加载必需配置

### 方案 C: 缓存机制

**目标**：复用已加载的内容

**措施**：
1. Prompt Cache（OpenAI/Anthropic 支持）
2. 减少 90% 重复 token 消耗

### 方案 D: 调整目标

**目标**：接受"启动 20k，任务 <5k"

**措施**：
1. 启动消耗：20k（一次性）
2. 每次任务：<5k（增量）
3. **实际成本**：启动 $0.30 + 每次任务 $0.05

---

## 推荐方案

**短期（立即）**：
- 方案 C：启用 Prompt Cache（最简单，效果最好）

**中期（1周）**：
- 方案 A：精简 SOUL 文件

**长期（1月）**：
- 方案 B：延迟加载架构

---

## 当前状态

| 方案 | 优先级 | 状态 |
|------|--------|------|
| Prompt Cache | 🔴 高 | ⏳ 待实施 |
| 精简 SOUL | 🟡 中 | ⏳ 待实施 |
| 延迟加载 | 🟢 低 | ⏳ 待规划 |
| 调整目标 | ⚪ 备选 | ⏳ 待讨论 |

---

## 成本影响（使用 Prompt Cache 后）

| 场景 | 优化前 | 使用 Cache | 节省 |
|------|--------|-----------|------|
| GM 启动 | 20k tokens ($0.30) | 2k tokens ($0.03) | 90% |
| GM 任务 | 5k tokens ($0.075) | 0.5k tokens ($0.0075) | 90% |
| **每次完整调用** | **$0.375** | **$0.0375** | **10x** |

---

**结论**：优化方向正确，但需要 Prompt Cache 才能真正达到目标。

**下一步**：启用 Prompt Cache，重新验证。
