# ClawOS 成本监控

## 监控指标

### 1. Token 消耗（按角色）

| 角色 | 模型 | 目标 tokens/次 | 实际 | 状态 |
|------|------|---------------|------|------|
| GM | Opus | <5k | - | 🟡 |
| validator | Opus | <5k | - | 🟡 |
| assistant | GLM-5 | <10k | - | 🟢 |
| PM | GLM-5 | <10k | - | 🟢 |
| Workers | 混合 | <20k | - | 🟢 |

### 2. 成本估算

#### 模型价格（2026-02）

| 模型 | 输入价格 | 输出价格 |
|------|----------|----------|
| Opus | $15/1M | $75/1M |
| Codex | $10/1M | $30/1M |
| GLM-5 | $0.5/1M | $0.5/1M |

#### 每日成本估算

| 场景 | 优化前 | 优化后 | 节省 |
|------|--------|--------|------|
| GM 调用 10 次 | $0.60 | $0.10 | $0.50 |
| validator 调用 5 次 | $0.30 | $0.05 | $0.25 |
| creator-writing 10 次 | $0.50 | $0.10 | $0.40 |
| **每日总计** | **$1.40** | **$0.25** | **$1.15** |

#### 每月成本估算

| 场景 | 优化前 | 优化后 | 节省 |
|------|--------|--------|------|
| 工作日 (22天) | $30.80 | $5.50 | $25.30 |
| 全月 (30天) | $42.00 | $7.50 | $34.50 |

### 3. 成本节省来源

| 优化项 | 节省比例 | 金额/月 |
|--------|----------|---------|
| GM <5k tokens | 80% | ~$15 |
| validator <5k tokens | 80% | ~$8 |
| creator-writing 分级 | 90% | ~$10 |
| **总计** | **~80%** | **~$33** |

---

## 告警阈值

### 日告警

| 指标 | 阈值 | 告警方式 |
|------|------|----------|
| 单日成本 | >$2 | iMessage |
| GM tokens | >10k | iMessage |
| validator tokens | >10k | iMessage |

### 月告警

| 指标 | 阈值 | 告警方式 |
|------|------|----------|
| 月成本 | >$20 | iMessage + Email |
| Opus 调用 | >100次 | iMessage |

---

## 监控脚本

```bash
# 运行成本监控
~/openclaw-system/clawos/scripts/monitor-cost.sh
```

---

## 优化建议

### 短期
- ✅ 已完成: GM/validator token 限制
- ✅ 已完成: creator-writing 分级

### 中期
- [ ] 实现 Prompt Cache（降 90%）
- [ ] 批处理任务（降低调用次数）

### 长期
- [ ] 本地推理（关键任务）
- [ ] 知识蒸馏（小模型）

---

**最后更新**: 2026-02-26 09:52
